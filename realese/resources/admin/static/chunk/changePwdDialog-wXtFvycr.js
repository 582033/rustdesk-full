import{T as e,u as N,f as O}from"../entry/index-Czm67r7X.js";import{c as f}from"./_element-plus-T6dmKOyC.js";import{m as _,x as T,r as U,an as i,b as k,o as E,Y as t,e as s,u as d,a0 as g,a1 as P}from"./_@vue-DEM3y_BF.js";const F={__name:"changePwdDialog",props:{visible:Boolean},emits:["update:visible"],setup(b,{emit:v}){const C=b,m=_({get:()=>C.visible,set:u=>{w("update:visible",u)}}),w=v,r=T({old_password:"",new_password:"",confirmPwd:""}),h=_(u=>({old_password:[{required:!0,message:e("ParamRequired",{param:e("OldPassword")}),trigger:"blur"}],new_password:[{required:!0,message:e("ParamRequired",{param:e("NewPassword")}),trigger:"blur"},{validator:(a,l,o)=>{l===r.old_password?o(new Error(e("NewPasswordEqualOldPassword"))):o()},trigger:"blur"}],confirmPwd:[{required:!0,message:e("ParamRequired",{param:e("ConfirmPassword")}),trigger:"blur"},{validator:(a,l,o)=>{l!==r.new_password?o(new Error(e("PasswordNotMatchConfirmPassword"))):o()},trigger:"blur"}]})),p=U(null),V=()=>{w("update:visible",!1)},x=N(),q=async()=>{!await p.value.validate().catch(o=>!1)||(console.log("changePassword"),!await f.confirm(e("Confirm?",{param:e("ChangePassword")}),{confirmButtonText:e("Confirm"),cancelButtonText:e("Cancel")}).catch(o=>!1))||!await O(r).catch(o=>!1)||f.alert(e("OperationSuccess"),e("ChangePassword"),{autofocus:!0,confirmButtonText:"OK",callback:o=>{x.logout(),window.location.reload()}})};return(u,a)=>{const l=i("el-input"),o=i("el-form-item"),c=i("el-button"),y=i("el-form"),B=i("el-dialog");return E(),k(B,{modelValue:m.value,"onUpdate:modelValue":a[3]||(a[3]=n=>m.value=n),width:"50%","show-close":!1},{default:t(()=>[s(y,{ref_key:"cpwd",ref:p,model:r,rules:h.value,"label-width":"150px","label-position":"left",style:{"margin-top":"20px"}},{default:t(()=>[s(o,{label:d(e)("OldPassword"),prop:"old_password"},{default:t(()=>[s(l,{modelValue:r.old_password,"onUpdate:modelValue":a[0]||(a[0]=n=>r.old_password=n),placeholder:d(e)("For OIDC login without a password, enter any 4-20 letters"),"show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(o,{label:d(e)("NewPassword"),prop:"new_password"},{default:t(()=>[s(l,{modelValue:r.new_password,"onUpdate:modelValue":a[1]||(a[1]=n=>r.new_password=n),"show-password":""},null,8,["modelValue"])]),_:1},8,["label"]),s(o,{label:d(e)("ConfirmPassword"),prop:"confirmPwd"},{default:t(()=>[s(l,{modelValue:r.confirmPwd,"onUpdate:modelValue":a[2]||(a[2]=n=>r.confirmPwd=n),"show-password":""},null,8,["modelValue"])]),_:1},8,["label"]),s(o,null,{default:t(()=>[s(c,{onClick:V},{default:t(()=>[g(P(d(e)("Cancel")),1)]),_:1}),s(c,{type:"primary",onClick:q},{default:t(()=>[g(P(d(e)("Confirm")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}};export{F as _};
