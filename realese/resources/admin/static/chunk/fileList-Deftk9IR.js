import{a as q}from"./reponsitories-DTEM92T6.js";import{T as t}from"../entry/index-Czm67r7X.js";import{s as C}from"./file-Dmzv2BFm.js";import{Y as B}from"./_@element-plus-CvluYIrs.js";import{l as Z,aa as G,w as T,r as x,an as s,at as H,c as F,o as u,e as l,Y as a,u as e,a0 as p,a1 as i,Z as J,b as g,P as K,_ as O}from"./_@vue-DEM3y_BF.js";import"./time-B3DnmeFu.js";import"./_element-plus-T6dmKOyC.js";import"./__vendor-BGruaAdM.js";import"./_@popperjs-DB1lLFnh.js";import"./_axios-BtuGy7By.js";const W={key:1},z=3,de={__name:"fileList",setup(X){const{listRes:b,listQuery:d,getList:h,handlerQuery:V,del:U,batchdel:A,toExport:I}=q();Z(h),G(h),T(()=>d.page,h),T(()=>d.page_size,V);const m=x(!1),N=x([]),E=_=>{N.value=_,m.value=!0},w=x([]),L=_=>{w.value=_},R=()=>{w.value.length!==0&&A(w.value)};return(_,r)=>{const D=s("el-input"),v=s("el-form-item"),c=s("el-button"),$=s("el-form"),y=s("el-card"),n=s("el-table-column"),P=s("el-icon"),S=s("el-tag"),k=s("el-table"),M=s("el-pagination"),Q=s("el-dialog"),Y=H("loading");return u(),F("div",null,[l(y,{class:"list-query",shadow:"hover"},{default:a(()=>[l($,{inline:"","label-width":"80px"},{default:a(()=>[l(v,{label:e(t)("Peer")},{default:a(()=>[l(D,{modelValue:e(d).peer_id,"onUpdate:modelValue":r[0]||(r[0]=o=>e(d).peer_id=o),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(v,{label:e(t)("FromPeer")},{default:a(()=>[l(D,{modelValue:e(d).from_peer,"onUpdate:modelValue":r[1]||(r[1]=o=>e(d).from_peer=o),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(v,null,{default:a(()=>[l(c,{type:"primary",onClick:e(V)},{default:a(()=>[p(i(e(t)("Filter")),1)]),_:1},8,["onClick"]),l(c,{type:"danger",onClick:R},{default:a(()=>[p(i(e(t)("BatchDelete")),1)]),_:1}),l(c,{type:"success",onClick:e(I)},{default:a(()=>[p(i(e(t)("Export")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),l(y,{class:"list-body",shadow:"hover"},{default:a(()=>[J((u(),g(k,{data:e(b).list,border:"","max-height":"750",onSelectionChange:L},{default:a(()=>[l(n,{type:"selection",align:"center",width:"50"}),l(n,{prop:"id",label:"ID",align:"center",width:"100"}),l(n,{label:e(t)("Peer"),prop:"peer_id",align:"center",width:"120"},null,8,["label"]),l(n,{label:e(t)("FromPeer"),prop:"from_peer",align:"center",width:"120"},null,8,["label"]),l(n,{label:e(t)("FromName"),prop:"from_name",align:"center",width:"120"},null,8,["label"]),l(n,{label:e(t)("Ip"),prop:"ip",align:"center",width:"120"},null,8,["label"]),l(n,{prop:"type",label:e(t)("Type"),align:"center",width:"200"},{default:a(({row:o})=>[o.type===1?(u(),g(S,{key:0,type:"warning"},{default:a(()=>[p(i(e(t)("ToRemote"))+": ",1),l(P,null,{default:a(()=>[l(e(B))]),_:1}),p(" "+i(o.peer_id),1)]),_:2},1024)):(u(),g(S,{key:1},{default:a(()=>[p(i(e(t)("ToLocal"))+": ",1),l(P,null,{default:a(()=>[l(e(B))]),_:1}),p(" "+i(o.from_peer),1)]),_:2},1024))]),_:1},8,["label"]),l(n,{prop:"num",label:e(t)("Num"),align:"center",width:"100"},null,8,["label"]),l(n,{label:e(t)("FileInfo"),align:"center",width:"300"},{default:a(({row:o})=>[o.is_file?(u(),F("div",W,i(e(C)(o.info.files[0][1])),1)):(u(),F(K,{key:0},[l(k,{size:"small",data:o.info?.files?.filter((f,j)=>j<z),fit:""},{default:a(()=>[l(n,{prop:"0",label:e(t)("FileName"),align:"center",width:"150","show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"1",label:e(t)("Size"),align:"center"},{default:a(({row:f})=>[p(i(e(C)(f[1])),1)]),_:1},8,["label"])]),_:2},1032,["data"]),o.info.files.length>z?(u(),g(c,{key:0,size:"small",style:{width:"100%","margin-top":"5px"},type:"primary",onClick:f=>E(o.info.files)},{default:a(()=>[p(i(e(t)("More"))+"("+i(o.info.files.length-z)+") ",1)]),_:2},1032,["onClick"])):O("",!0)],64))]),_:1},8,["label"]),l(n,{prop:"path",label:e(t)("Path"),align:"center",width:"150","show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"uuid",label:"uuid",align:"center",width:"120","show-overflow-tooltip":""}),l(n,{prop:"created_at",label:e(t)("CreatedAt"),align:"center","min-width":"120"},null,8,["label"]),l(n,{label:e(t)("Actions"),align:"center",width:"150",fixed:"right"},{default:a(({row:o})=>[l(c,{type:"danger",onClick:f=>e(U)(o)},{default:a(()=>[p(i(e(t)("Delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[Y,e(b).loading]])]),_:1}),l(y,{class:"list-page",shadow:"hover"},{default:a(()=>[l(M,{background:"",layout:"prev, pager, next, sizes, jumper","page-sizes":[10,20,50,100],"page-size":e(d).page_size,"onUpdate:pageSize":r[2]||(r[2]=o=>e(d).page_size=o),"current-page":e(d).page,"onUpdate:currentPage":r[3]||(r[3]=o=>e(d).page=o),total:e(b).total},null,8,["page-size","current-page","total"])]),_:1}),l(Q,{modelValue:m.value,"onUpdate:modelValue":r[5]||(r[5]=o=>m.value=o),title:e(t)("File")},{default:a(()=>[l(k,{data:N.value,"max-height":"800px"},{default:a(()=>[l(n,{type:"index",label:e(t)("IndexNum"),width:"120",align:"center"},null,8,["label"]),l(n,{prop:"0",label:e(t)("FileName"),align:"center"},null,8,["label"]),l(n,{prop:"1",label:e(t)("Size"),align:"center"},{default:a(({row:o})=>[p(i(e(C)(o[1])),1)]),_:1},8,["label"])]),_:1},8,["data"]),l(c,{onClick:r[4]||(r[4]=o=>m.value=!1),style:{"margin-top":"20px",width:"100%"},type:"primary"},{default:a(()=>[p(i(e(t)("Close")),1)]),_:1})]),_:1},8,["modelValue","title"])])}}};export{de as default};
