import{s as l,T as s}from"../entry/index-Czm67r7X.js";import{f as B}from"./time-B3DnmeFu.js";import{j as g,d as h}from"./file-Dmzv2BFm.js";import{b as r,c as u}from"./_element-plus-T6dmKOyC.js";import{x as p}from"./_@vue-DEM3y_BF.js";function d(t){return l({url:"/audit_conn/list",params:t})}function C(t){return l({url:"/audit_conn/delete",method:"post",data:t})}function T(t){return l({url:"/audit_conn/batchDelete",method:"post",data:t})}function m(t){return l({url:"/audit_file/list",params:t})}function D(t){return l({url:"/audit_file/delete",method:"post",data:t})}function b(t){return l({url:"/audit_file/batchDelete",method:"post",data:t})}function O(){const t=p({list:[],total:0,loading:!1}),n=p({page:1,page_size:10,peer_id:null,from_peer:null}),c=async()=>{t.loading=!0;const a=await d(n).catch(e=>!1);t.loading=!1,a&&(t.list=a.data.list.map(e=>(e.close_time=e.close_time?B(e.close_time*1e3):"-",e)),t.total=a.data.total)};return{listRes:t,listQuery:n,getList:c,handlerQuery:()=>{n.page===1?c():n.page=1},del:async a=>{if(!await u.confirm(s("Confirm?",{param:s("Delete")}),{confirmButtonText:s("Confirm"),cancelButtonText:s("Cancel"),type:"warning"}).catch(f=>!1))return!1;await C({id:a.id}).catch(f=>!1)&&(r.success(s("OperationSuccess")),c())},batchdel:async a=>{const e=a.map(i=>i.id);if(!e.length)return r.warning(s("PleaseSelectData")),!1;if(!await u.confirm(s("Confirm?",{param:s("BatchDelete")}),{confirmButtonText:s("Confirm"),cancelButtonText:s("Cancel"),type:"warning"}).catch(i=>!1))return!1;await T({ids:e}).catch(i=>!1)&&(r.success(s("OperationSuccess")),c())},toExport:async()=>{const a={...n};a.page_size=1e6,a.page=1;const e=await d(a).catch(o=>!1);if(e){const o=g(e.data.list);h(o,"connectLog.csv")}}}}function R(){const t=p({list:[],total:0,loading:!1}),n=p({page:1,page_size:10,peer_id:null,from_peer:null}),c=async()=>{t.loading=!0;const a=await m(n).catch(e=>!1);t.loading=!1,a&&(t.list=a.data.list.map(e=>(e.info=e.info?JSON.parse(e.info):"-",e)),t.total=a.data.total)};return{listRes:t,listQuery:n,getList:c,handlerQuery:()=>{n.page===1?c():n.page=1},del:async a=>{if(!await u.confirm(s("Confirm?",{param:s("Delete")}),{confirmButtonText:s("Confirm"),cancelButtonText:s("Cancel"),type:"warning"}).catch(f=>!1))return!1;await D({id:a.id}).catch(f=>!1)&&(r.success(s("OperationSuccess")),c())},batchdel:async a=>{const e=a.map(i=>i.id);if(!e.length)return r.warning(s("PleaseSelectData")),!1;if(!await u.confirm(s("Confirm?",{param:s("BatchDelete")}),{confirmButtonText:s("Confirm"),cancelButtonText:s("Cancel"),type:"warning"}).catch(i=>!1))return!1;await b({ids:e}).catch(i=>!1)&&(r.success(s("OperationSuccess")),c())},toExport:async()=>{const a={...n};a.page_size=1e6,a.page=1;const e=await m(a).catch(o=>!1);if(e){const o=g(e.data.list);h(o,"fileTransformLog.csv")}}}}export{R as a,O as u};
