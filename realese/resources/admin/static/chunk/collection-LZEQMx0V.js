import{T as o}from"../entry/index-Czm67r7X.js";import{u as Y}from"./collection-CALyNR1w.js";import{_ as Z}from"./rule-FMj29F2s.js";import{l as G}from"./global-Czwz-x68.js";import{l as H,aa as J,w as S,r as $,an as s,at as K,c as b,o as p,e as l,Y as a,u as e,P as B,ah as N,b as w,a0 as r,a1 as d,Z as W,_ as X,A as ee}from"./_@vue-DEM3y_BF.js";import"./_element-plus-T6dmKOyC.js";import"./__vendor-BGruaAdM.js";import"./_@element-plus-CvluYIrs.js";import"./_@popperjs-DB1lLFnh.js";import"./_axios-BtuGy7By.js";const le={key:0},_e={__name:"collection",setup(te){const{allUsers:v,getAllUsers:q}=G();q();const{listRes:k,listQuery:i,getList:y,handlerQuery:U,del:E,formVisible:f,formData:m,toEdit:O,toAdd:F,submit:L}=Y("admin");i.is_my=0,H(y),J(y),S(()=>i.page,y),S(()=>i.page_size,U);const A=$({}),V=$(!1),P=h=>{A.value=h,V.value=!0,console.log("showRules")};return(h,n)=>{const x=s("el-option"),z=s("el-select"),_=s("el-form-item"),u=s("el-button"),R=s("el-form"),C=s("el-card"),c=s("el-table-column"),Q=s("el-tag"),T=s("el-table"),j=s("el-pagination"),I=s("el-input"),D=s("el-dialog"),M=K("loading");return p(),b("div",null,[l(C,{class:"list-query",shadow:"hover"},{default:a(()=>[l(R,{inline:"","label-width":"80px"},{default:a(()=>[l(_,{label:e(o)("Owner")},{default:a(()=>[l(z,{modelValue:e(i).user_id,"onUpdate:modelValue":n[0]||(n[0]=t=>e(i).user_id=t),clearable:""},{default:a(()=>[(p(!0),b(B,null,N(e(v),t=>(p(),w(x,{key:t.id,label:t.username,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(_,null,{default:a(()=>[l(u,{type:"primary",onClick:e(U)},{default:a(()=>[r(d(e(o)("Filter")),1)]),_:1},8,["onClick"]),l(u,{type:"danger",onClick:e(F)},{default:a(()=>[r(d(e(o)("Add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),l(C,{class:"list-body",shadow:"hover"},{default:a(()=>[W((p(),w(T,{data:e(k).list,border:""},{default:a(()=>[l(c,{prop:"id",label:"ID",align:"center"}),l(c,{prop:"user_id",label:e(o)("Owner"),align:"center"},{default:a(({row:t})=>[t.user_id?(p(),b("span",le,[l(Q,null,{default:a(()=>[r(d(e(v)?.find(g=>g.id===t.user_id)?.username),1)]),_:2},1024)])):X("",!0)]),_:1},8,["label"]),l(c,{prop:"name",label:e(o)("AddressBook"),align:"center"},null,8,["label"]),l(c,{prop:"created_at",label:e(o)("CreatedAt"),align:"center"},null,8,["label"]),l(c,{label:e(o)("Actions"),align:"center","class-name":"table-actions",width:"600",fixed:"right"},{default:a(({row:t})=>[l(u,{type:"primary",onClick:g=>P(t)},{default:a(()=>[r(d(e(o)("ShareRules")),1)]),_:2},1032,["onClick"]),l(u,{onClick:g=>e(O)(t)},{default:a(()=>[r(d(e(o)("Edit")),1)]),_:2},1032,["onClick"]),l(u,{type:"danger",onClick:g=>e(E)(t)},{default:a(()=>[r(d(e(o)("Delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[M,e(k).loading]])]),_:1}),l(C,{class:"list-page",shadow:"hover"},{default:a(()=>[l(j,{background:"",layout:"prev, pager, next, sizes, jumper","page-sizes":[10,20,50,100],"page-size":e(i).page_size,"onUpdate:pageSize":n[1]||(n[1]=t=>e(i).page_size=t),"current-page":e(i).page,"onUpdate:currentPage":n[2]||(n[2]=t=>e(i).page=t),total:e(k).total},null,8,["page-size","current-page","total"])]),_:1}),l(D,{modelValue:e(f),"onUpdate:modelValue":n[6]||(n[6]=t=>ee(f)?f.value=t:null),width:"800",title:e(m).id?e(o)("Update"):e(o)("Create")},{default:a(()=>[l(R,{class:"dialog-form",ref:"form",model:e(m),"label-width":"120px"},{default:a(()=>[l(_,{label:e(o)("Owner"),prop:"user_id",required:""},{default:a(()=>[l(z,{modelValue:e(m).user_id,"onUpdate:modelValue":n[3]||(n[3]=t=>e(m).user_id=t)},{default:a(()=>[(p(!0),b(B,null,N(e(v),t=>(p(),w(x,{key:t.id,label:t.username,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(_,{label:e(o)("Name"),prop:"name",required:""},{default:a(()=>[l(I,{modelValue:e(m).name,"onUpdate:modelValue":n[4]||(n[4]=t=>e(m).name=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(_,null,{default:a(()=>[l(u,{onClick:n[5]||(n[5]=t=>f.value=!1)},{default:a(()=>[r(d(e(o)("Cancel")),1)]),_:1}),l(u,{onClick:e(L),type:"primary"},{default:a(()=>[r(d(e(o)("Submit")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(D,{modelValue:V.value,"onUpdate:modelValue":n[7]||(n[7]=t=>V.value=t),title:e(o)("ShareRules"),"destroy-on-close":"",top:"5vh",width:"80%"},{default:a(()=>[l(Z,{collection:A.value,is_my:0},null,8,["collection"])]),_:1},8,["modelValue","title"])])}}};export{_e as default};
