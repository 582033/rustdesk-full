import{l as R}from"./peer-D9oS7b6H.js";import{u as re,c as me,t as pe,b as be}from"./peer-HGjDncml.js";import{_ as fe,d as _e,T as n}from"../entry/index-Czm67r7X.js";import{t as ge}from"./time-B3DnmeFu.js";import{j as ce,d as ve}from"./file-Dmzv2BFm.js";import{h as Ve}from"./clipboard-CMGTTqw4.js";import{T as Ce}from"./_@element-plus-CvluYIrs.js";import{b as I}from"./_element-plus-T6dmKOyC.js";import{x as O,l as j,aa as ye,w as Q,r as S,m as we,an as g,at as ke,c as w,o as f,e as l,Y as o,u as a,P as U,ah as A,b as C,a0 as _,a1 as c,Z as Ue,a as T,V as Ae,_ as xe,A as Be}from"./_@vue-DEM3y_BF.js";import"./__vendor-BGruaAdM.js";import"./collection-CALyNR1w.js";import"./index-B1Bs_yz0.js";import"./peer-DzPg3Mq6.js";import"./_axios-BtuGy7By.js";import"./_@popperjs-DB1lLFnh.js";const De={class:"last_oline_time"},he={__name:"index",setup(Le){const W=_e(),y=O({list:[],total:0,loading:!1}),r=O({page:1,page_size:10,time_ago:null,id:"",hostname:""}),h=async()=>{y.loading=!0;const u=await R(r).catch(t=>!1);y.loading=!1,u&&(y.list=u.data.list,y.total=u.data.total)},H=()=>{r.page===1?h():r.page=1};j(h),ye(h),Q(()=>r.page,h),Q(()=>r.page_size,H);const z=S(!1),d=O({row_id:0,cpu:"",hostname:"",id:"",memory:"",os:"",username:"",uuid:"",version:""}),Y=u=>{z.value=!0,Object.keys(d).forEach(t=>{d[t]=u[t]})},N=u=>{let t=new Date().getTime(),i=new Date(u*1e3).getTime();return(t-i)/1e3},Z=we(()=>[{text:n("MinutesLess",{param:1},1),value:-60},{text:n("HoursLess",{param:1},1),value:-3600},{text:n("DaysLess",{param:1},1),value:-86400},{text:"---------",value:0},{text:n("MinutesAgo",{param:1},1),value:60},{text:n("HoursAgo",{param:1},1),value:3600},{text:n("DaysAgo",{param:1},1),value:86400},{text:n("MonthsAgo",{param:1},1),value:2592e3}]),G=async()=>{const u={...r};u.page_size=1e4,u.page=1;const t=await R(u).catch(i=>!1);if(t){const i=t.data.list.map(p=>(p.last_online_time=p.last_online_time?new Date(p.last_online_time*1e3).toLocaleString():"-",delete p.user_id,delete p.user,p)),s=ce(i);ve(s,"peers.csv")}},{platformList:J,formVisible:x,formData:m,collectionListResForUpdate:$,getCollectionListForUpdate:K,tagListRes:q,changeCollectionForUpdate:E,submit:X,fromPeer:ee}=re("my");j(K);const le=u=>{ee(u),x.value=!0},F=S([]),ae=u=>{F.value=u},B=S(!1),te=()=>{B.value=!0},V=S({collection_id:0,tags:[],peer_ids:[]}),oe=u=>{V.value.tags=[],E(u)},ne=async()=>{if(F.value.length===0)return I.warning(n("PleaseSelectData")),!1;if(V.value.peer_ids=F.value.map(t=>t.row_id),!V.value.peer_ids.length)return I.warning(n("PleaseSelectData")),!1;await be(V.value).catch(t=>!1)&&(I.success(n("OperationSuccess")),B.value=!1)};return(u,t)=>{const i=g("el-input"),s=g("el-form-item"),p=g("el-option"),k=g("el-select"),v=g("el-button"),L=g("el-form"),P=g("el-card"),b=g("el-table-column"),se=g("el-icon"),de=g("el-table"),ue=g("el-pagination"),M=g("el-dialog"),ie=ke("loading");return f(),w("div",null,[l(P,{class:"list-query",shadow:"hover"},{default:o(()=>[l(L,{inline:"","label-width":"150px"},{default:o(()=>[l(s,{label:"ID"},{default:o(()=>[l(i,{modelValue:r.id,"onUpdate:modelValue":t[0]||(t[0]=e=>r.id=e),clearable:""},null,8,["modelValue"])]),_:1}),l(s,{label:a(n)("Hostname")},{default:o(()=>[l(i,{modelValue:r.hostname,"onUpdate:modelValue":t[1]||(t[1]=e=>r.hostname=e),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("LastOnlineTime")},{default:o(()=>[l(k,{modelValue:r.time_ago,"onUpdate:modelValue":t[2]||(t[2]=e=>r.time_ago=e),clearable:""},{default:o(()=>[(f(!0),w(U,null,A(Z.value,e=>(f(),C(p,{key:e.value,label:e.text,value:e.value,disabled:e.value===0},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(s,null,{default:o(()=>[l(v,{type:"primary",onClick:H},{default:o(()=>[_(c(a(n)("Filter")),1)]),_:1}),l(v,{type:"success",onClick:G},{default:o(()=>[_(c(a(n)("Export")),1)]),_:1}),l(v,{type:"primary",onClick:te},{default:o(()=>[_(c(a(n)("BatchAddToAB")),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(P,{class:"list-body",shadow:"hover"},{default:o(()=>[Ue((f(),C(de,{data:y.list,border:"",size:"small",onSelectionChange:ae},{default:o(()=>[l(b,{type:"selection",width:"55",align:"center"}),l(b,{prop:"id",label:"ID",align:"center",width:"150"},{default:o(({row:e})=>[T("span",null,[_(c(e.id)+" ",1),l(se,{onClick:D=>a(Ve)(e.id,D)},{default:o(()=>[l(a(Ce))]),_:2},1032,["onClick"])])]),_:1}),l(b,{prop:"cpu",label:"CPU",align:"center",width:"100","show-overflow-tooltip":""}),l(b,{prop:"hostname",label:a(n)("Hostname"),align:"center",width:"120"},null,8,["label"]),l(b,{prop:"memory",label:a(n)("Memory"),align:"center",width:"120"},null,8,["label"]),l(b,{prop:"os",label:a(n)("Os"),align:"center",width:"120","show-overflow-tooltip":""},null,8,["label"]),l(b,{prop:"last_online_time",label:a(n)("LastOnlineTime"),align:"center","min-width":"120"},{default:o(({row:e})=>[T("div",De,[T("span",null,c(e.last_online_time?a(ge)(e.last_online_time*1e3):"-"),1),t[27]||(t[27]=_()),T("span",{class:Ae(["dot",{red:N(e.last_online_time)>=60,green:N(e.last_online_time)<60}])},null,2)])]),_:1},8,["label"]),l(b,{prop:"last_online_ip",label:a(n)("LastOnlineIp"),align:"center","min-width":"120"},null,8,["label"]),l(b,{prop:"username",label:a(n)("Username"),align:"center",width:"120"},null,8,["label"]),l(b,{prop:"uuid",label:a(n)("Uuid"),align:"center",width:"120","show-overflow-tooltip":""},null,8,["label"]),l(b,{prop:"version",label:a(n)("Version"),align:"center",width:"80"},null,8,["label"]),l(b,{prop:"alias",label:a(n)("Alias"),align:"center",width:"80"},null,8,["label"]),l(b,{prop:"created_at",label:a(n)("CreatedAt"),align:"center",width:"150"},null,8,["label"]),l(b,{prop:"updated_at",label:a(n)("UpdatedAt"),align:"center",width:"150"},null,8,["label"]),l(b,{label:a(n)("Actions"),align:"center",width:"500","class-name":"table-actions",fixed:"right"},{default:o(({row:e})=>[l(v,{type:"success",onClick:D=>a(me)(e.id)},{default:o(()=>[_(c(a(n)("Link")),1)]),_:2},1032,["onClick"]),a(W).setting.appConfig.web_client?(f(),C(v,{key:0,type:"success",onClick:D=>a(pe)(e)},{default:o(()=>t[28]||(t[28]=[_("Web Client")])),_:2},1032,["onClick"])):xe("",!0),l(v,{type:"primary",onClick:D=>le(e)},{default:o(()=>[_(c(a(n)("AddToAddressBook")),1)]),_:2},1032,["onClick"]),l(v,{onClick:D=>Y(e)},{default:o(()=>[_(c(a(n)("View")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[ie,y.loading]])]),_:1}),l(P,{class:"list-page",shadow:"hover"},{default:o(()=>[l(ue,{background:"",layout:"prev, pager, next, sizes, jumper","page-sizes":[10,20,50,100],"page-size":r.page_size,"onUpdate:pageSize":t[3]||(t[3]=e=>r.page_size=e),"current-page":r.page,"onUpdate:currentPage":t[4]||(t[4]=e=>r.page=e),total:y.total},null,8,["page-size","current-page","total"])]),_:1}),l(M,{modelValue:z.value,"onUpdate:modelValue":t[13]||(t[13]=e=>z.value=e),title:a(n)("Information"),width:"800",style:{textAlign:"center"}},{default:o(()=>[l(L,{class:"dialog-form",ref:"form",model:d,"label-width":"120px"},{default:o(()=>[l(s,{label:"ID",prop:"id"},{default:o(()=>[l(i,{modelValue:d.id,"onUpdate:modelValue":t[5]||(t[5]=e=>d.id=e),disabled:""},null,8,["modelValue"])]),_:1}),l(s,{label:a(n)("Username"),prop:"username"},{default:o(()=>[l(i,{modelValue:d.username,"onUpdate:modelValue":t[6]||(t[6]=e=>d.username=e),disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Hostname"),prop:"hostname"},{default:o(()=>[l(i,{modelValue:d.hostname,"onUpdate:modelValue":t[7]||(t[7]=e=>d.hostname=e),disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:"CPU",prop:"cpu"},{default:o(()=>[l(i,{modelValue:d.cpu,"onUpdate:modelValue":t[8]||(t[8]=e=>d.cpu=e),disabled:""},null,8,["modelValue"])]),_:1}),l(s,{label:a(n)("Memory"),prop:"memory"},{default:o(()=>[l(i,{modelValue:d.memory,"onUpdate:modelValue":t[9]||(t[9]=e=>d.memory=e),disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Os"),prop:"os"},{default:o(()=>[l(i,{modelValue:d.os,"onUpdate:modelValue":t[10]||(t[10]=e=>d.os=e),disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Uuid"),prop:"uuid"},{default:o(()=>[l(i,{modelValue:d.uuid,"onUpdate:modelValue":t[11]||(t[11]=e=>d.uuid=e),disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Version"),prop:"version"},{default:o(()=>[l(i,{modelValue:d.version,"onUpdate:modelValue":t[12]||(t[12]=e=>d.version=e),disabled:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(M,{modelValue:a(x),"onUpdate:modelValue":t[22]||(t[22]=e=>Be(x)?x.value=e:null),width:"800",title:a(n)("Create")},{default:o(()=>[l(L,{class:"dialog-form",ref:"form",model:a(m),"label-width":"120px"},{default:o(()=>[l(s,{label:a(n)("AddressBookName"),required:"",prop:"collection_id"},{default:o(()=>[l(k,{modelValue:a(m).collection_id,"onUpdate:modelValue":t[14]||(t[14]=e=>a(m).collection_id=e),clearable:"",onChange:a(E)},{default:o(()=>[l(p,{value:0,label:a(n)("MyAddressBook")},null,8,["label"]),(f(!0),w(U,null,A(a($).list,e=>(f(),C(p,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1},8,["label"]),l(s,{label:"ID",prop:"id",required:""},{default:o(()=>[l(i,{modelValue:a(m).id,"onUpdate:modelValue":t[15]||(t[15]=e=>a(m).id=e)},null,8,["modelValue"])]),_:1}),l(s,{label:a(n)("Username"),prop:"username"},{default:o(()=>[l(i,{modelValue:a(m).username,"onUpdate:modelValue":t[16]||(t[16]=e=>a(m).username=e)},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Alias"),prop:"alias"},{default:o(()=>[l(i,{modelValue:a(m).alias,"onUpdate:modelValue":t[17]||(t[17]=e=>a(m).alias=e)},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Hostname"),prop:"hostname"},{default:o(()=>[l(i,{modelValue:a(m).hostname,"onUpdate:modelValue":t[18]||(t[18]=e=>a(m).hostname=e)},null,8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Platform"),prop:"platform"},{default:o(()=>[l(k,{modelValue:a(m).platform,"onUpdate:modelValue":t[19]||(t[19]=e=>a(m).platform=e)},{default:o(()=>[(f(!0),w(U,null,A(a(J),e=>(f(),C(p,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Tags"),prop:"tags"},{default:o(()=>[l(k,{modelValue:a(m).tags,"onUpdate:modelValue":t[20]||(t[20]=e=>a(m).tags=e),multiple:""},{default:o(()=>[(f(!0),w(U,null,A(a(q).list,e=>(f(),C(p,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(s,null,{default:o(()=>[l(v,{onClick:t[21]||(t[21]=e=>x.value=!1)},{default:o(()=>[_(c(a(n)("Cancel")),1)]),_:1}),l(v,{onClick:a(X),type:"primary"},{default:o(()=>[_(c(a(n)("Submit")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(M,{modelValue:B.value,"onUpdate:modelValue":t[26]||(t[26]=e=>B.value=e),width:"800",title:a(n)("Create")},{default:o(()=>[l(L,{class:"dialog-form",ref:"form",model:V.value,"label-width":"120px"},{default:o(()=>[l(s,{label:a(n)("AddressBookName"),required:"",prop:"collection_id"},{default:o(()=>[l(k,{modelValue:V.value.collection_id,"onUpdate:modelValue":t[23]||(t[23]=e=>V.value.collection_id=e),clearable:"",onChange:oe},{default:o(()=>[l(p,{value:0,label:a(n)("MyAddressBook")},null,8,["label"]),(f(!0),w(U,null,A(a($).list,e=>(f(),C(p,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(s,{label:a(n)("Tags"),prop:"tags"},{default:o(()=>[l(k,{modelValue:V.value.tags,"onUpdate:modelValue":t[24]||(t[24]=e=>V.value.tags=e),multiple:""},{default:o(()=>[(f(!0),w(U,null,A(a(q).list,e=>(f(),C(p,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(s,null,{default:o(()=>[l(v,{onClick:t[25]||(t[25]=e=>B.value=!1)},{default:o(()=>[_(c(a(n)("Cancel")),1)]),_:1}),l(v,{onClick:ne,type:"primary"},{default:o(()=>[_(c(a(n)("Submit")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Qe=fe(he,[["__scopeId","data-v-46692e36"]]);export{Qe as default};
